(self.webpackChunkdash_bio=self.webpackChunkdash_bio||[]).push([[232],{8716:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var r=n(9196),o=n.n(r),i=n(5537),c="function"==typeof Object.assign?Object.assign:function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1,r=arguments.length;n<r;){var o=arguments[n];if(null!=o)for(var c in o)(0,i.Z)(c,o)&&(t[c]=o[c]);n+=1}return t},s=(0,n(3993).Z)((function(e){return c.apply(null,[{}].concat(e))})),a=n(9278),u=n(3316),l=n.n(u),p=n(5073),f=n(1215);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===h(o)?o:String(o)),r)}var o}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function y(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var m=l()((function(e){for(var t=p.speckSystem.new(),n=0;n<e.length;n++){var r=e[n];p.speckSystem.addAtom(t,r.symbol,r.x,r.y,r.z)}return p.speckSystem.center(t),p.speckSystem.calculateBonds(t),t})),g=function(e){return s([e,{rotation:new Float32Array(e.rotation),translation:s([e.translation])}])},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign(e,t)};function k(e){e.style.width="100%",e.style.height="100%",e.width=e.offsetWidth,e.height=e.offsetHeight}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(s,e);var t,n,r,i,c=(r=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(r);if(i){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=c.call(this,e)).state={renderer:null},t.eventListenDestructor=function(){},t.refreshView=!1,t.propsReconcileTimeout=null,t.view=R(p.speckView.new(),e.view),t.props.setProps({view:g(t.view)}),t.setCanvasRef=function(e){t.canvas=e},t.setContainerRef=function(e){t.container=e},t.loop=t.loop.bind(b(t)),t.loadStructure=t.loadStructure.bind(b(t)),t.propsReconcile=t.propsReconcile.bind(b(t)),t.propsReconcileSchedule=t.propsReconcileSchedule.bind(b(t)),t}return t=s,n=[{key:"componentDidMount",value:function(){var e=this,t=this.props.scrollZoom,n=this.canvas,r=this.container,o=new p.speckRenderer(n,200,300);this.setState({renderer:o},this.loadStructure),this.eventListenDestructor=(0,p.speckInteractions)({scrollZoom:t,container:r,getRotation:function(){return e.view.rotation},setRotation:function(t){e.view=R(e.view,{rotation:t}),e.propsReconcileSchedule()},getTranslation:function(){return e.view.translation},setTranslation:function(t){e.view=R(e.view,{translation:t}),e.propsReconcileSchedule()},getZoom:function(){return e.view.zoom},setZoom:function(t){e.view=R(e.view,{zoom:t}),e.propsReconcileSchedule()},refreshView:function(){return e.refreshView=!0}}),k(n),this.loop()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.data,r=t.view,o=t.presetView,i=t.style,c=this.state.renderer,s=this.view,u=!1;e.presetView!==o&&(s=R(s,p.speckPresetViews[o]),this.propsReconcileSchedule(),u=!0),function(e){for(var t=JSON.stringify(e),n=1;n<arguments.length;n++)if(t===JSON.stringify(arguments[n]))return!0;return!1}(r,e.view,s)||(s=R(s,r),u=!0),(0,a.Z)(n,e.data)||(u=!0),(0,a.Z)(i,e.style)||(u=!0),u&&(this.view=s,c&&this.loadStructure())}},{key:"componentWillUnmount",value:function(){this.state.renderer=null,this.eventListenDestructor(),this.props.setProps({view:this.view})}},{key:"propsReconcile",value:function(){(0,a.Z)(this.view,this.props.view)||this.props.setProps({view:g(this.view)})}},{key:"propsReconcileSchedule",value:function(){clearTimeout(this.propsReconcileTimeout),this.propsReconcileTimeout=setTimeout(this.propsReconcile,500)}},{key:"loadStructure",value:function(){var e=this.props.data,t=this.canvas;if(0!==e.length){var n=this.state.renderer,r=this.view,o=m(e);n.setSystem(o,r),n.setResolution(r.resolution,r.aoRes),this.refreshView=!0,k(t)}}},{key:"loop",value:function(){this.state.renderer&&this.view&&(this.refreshView&&(this.state.renderer.reset(),this.refreshView=!1),this.state.renderer.render(this.view)),requestAnimationFrame(this.loop)}},{key:"colorLegend",value:function(){var e=this,t=Array.from(new Set(this.props.data.map((function(e){return e.symbol})))).map((function(e){return p.speckElements[e]}));return o().createElement("div",{style:{backgroundColor:"white",width:"60px",height:"fit-content",padding:"10px",position:"absolute",right:"-80px",top:0},id:"speck-color-legend"},t.map((function(t){var n={backgroundColor:e.colorToRgb(t.color),width:"16px",height:"16px",display:"inline-block",borderRadius:"50%",marginRight:"20px",border:"0.25px solid black"};return o().createElement("p",{style:{display:"flex",alignItems:"center"},key:t.symbol},o().createElement("span",{style:n}),o().createElement("span",null,t.symbol))})))}},{key:"colorToRgb",value:function(e){var t=this,n=e.map((function(e){return 255*e})).map((function(e){return t.lightenColor(e)})).join(", ");return"rgb(".concat(n,")")}},{key:"lightenColor",value:function(e){return.5*e+127.5}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.loading_state,r=e.showLegend,i=e.style;return o().createElement("div",{id:t,ref:this.setContainerRef,style:i,"data-dash-is-loading":n&&n.is_loading||void 0},o().createElement("canvas",{ref:this.setCanvasRef}),r&&this.colorLegend())}}],n&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.Component);S.defaultProps=f.lG,S.propTypes=f.iG},3316:function(e){function t(e,t,n,r){var o,i=null==(o=r)||"number"==typeof o||"boolean"==typeof o?r:n(r),c=t.get(i);return void 0===c&&(c=e.call(this,r),t.set(i,c)),c}function n(e,t,n){var r=Array.prototype.slice.call(arguments,3),o=n(r),i=t.get(o);return void 0===i&&(i=e.apply(this,r),t.set(o,i)),i}function r(e,t,n,r,o){return n.bind(t,e,r,o)}function o(e,o){return r(e,this,1===e.length?t:n,o.cache.create(),o.serializer)}function i(){return JSON.stringify(arguments)}function c(){this.cache=Object.create(null)}c.prototype.has=function(e){return e in this.cache},c.prototype.get=function(e){return this.cache[e]},c.prototype.set=function(e,t){this.cache[e]=t};var s={create:function(){return new c}};e.exports=function(e,t){var n=t&&t.cache?t.cache:s,r=t&&t.serializer?t.serializer:i;return(t&&t.strategy?t.strategy:o)(e,{cache:n,serializer:r})},e.exports.strategies={variadic:function(e,t){return r(e,this,n,t.cache.create(),t.serializer)},monadic:function(e,n){return r(e,this,t,n.cache.create(),n.serializer)}}}}]);
//# sourceMappingURL=async-speck.js.map