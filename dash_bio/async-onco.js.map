{"version":3,"sources":["webpack:///./src/lib/fragments/OncoPrint.react.js","webpack:///./node_modules/react-oncoprint/lib/index.js","webpack:///./node_modules/react-oncoprint/lib/components/OncoPrint.js","webpack:///./node_modules/react-oncoprint/lib/components/utils.js","webpack:///./node_modules/react-oncoprint/lib/components/PrecomputedComparator.js"],"names":["OncoPrint","props","handleChange","bind","event","eventObj","JSON","stringify","this","setProps","eventDatum","id","onChange","omit","Component","defaultProps","propTypes","Object","defineProperty","exports","value","enumerable","get","_OncoPrint","default","obj","__esModule","_react","newObj","key","prototype","hasOwnProperty","call","desc","getOwnPropertyDescriptor","set","_interopRequireWildcard","_propTypes","_interopRequireDefault","_lodash","_reactPlotly","_utils","_typeof","Symbol","iterator","constructor","_extends","assign","target","i","arguments","length","source","apply","_toConsumableArray","arr","Array","isArray","arr2","_arrayWithoutHoles","iter","toString","from","_iterableToArray","TypeError","_nonIterableSpread","_defineProperties","descriptor","configurable","writable","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_setPrototypeOf","p","_assertThisInitialized","self","ReferenceError","_PureComponent","_this","instance","Constructor","_classCallCheck","state","xStart","xEnd","resetWindowing","debounce","protoProps","staticProps","subClass","superClass","create","_inherits","range","eventType","points","type","name","data","text","curveNumber","x","y","setState","_this$props","inputData","padding","colorscale","backgroundcolor","events","aggregate","genes","getSortedGenes","samples","getSortedSamples","ratios","getEventRatiosPerGene","formatGenes","list","map","gene","concat","base","bBackground","tBackground","xBackground","yBackground","forEach","s","push","fill","hoverinfo","marker","color","orientation","keys","aggr","width","text_arr","sample","getDisplayName","indexes","e","findIndex","getColor","getGeneNames","_this$props2","showlegend","showoverview","height","_this$state","layout","barmode","hovermode","xaxis","showgrid","showticklabels","zeroline","automargin","yaxis","fixedrange","margin","t","r","b","rangeslider","autorange","_this$resetWindowing","prevProps","prevState","_this$resetWindowing2","getData","_this$getLayout","getLayout","other","style","useResizeHandler","createElement","onClick","onHover","onRelayout","PureComponent","array","number","oneOfType","bool","object","string","createSortEventsForGeneComparator","createSamplesMap","isMutation","SupportedEvents","_PrecomputedComparator","MutationEventTypes","MISSENSE","colorHTML","displayName","INFRAME","TRUNC","FUSION","AMP","GAIN","HETLOSS","HOMDEL","UP","DOWN","AlterationsOrder","undefined","MutationsOrder","ExpressionsOrder","filter","Set","reverse","nbSamples","reduce","acc","Math","floor","includes","sign","samplesMap","v","MUT","alteration","s1","s2","d1","d2","cna","CNA","mut","exp","EXP","sortEventsForGene","sort","perGeneComparators","samplesToIndex","sortedSamples","result","absoluteResult","nextResult","compare","nextAbsoluteResult","abs","samplesComparator","out","k","eventName","isObject","hasElementsInInterval","func","lowerBound","upperBound","middle","middle_val","lowerCounter","upperCounter","PrecomputedComparator","comparator","sortedData","changePoints","_i","i1","i2","shouldNegateResult","tmp","res"],"mappings":"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","file":"async-onco.js","sourcesContent":["import React, {Component} from 'react';\nimport {omit} from 'ramda';\n\nimport {OncoPrint as PreOncoPrint} from 'react-oncoprint';\nimport {propTypes, defaultProps} from '../components/OncoPrint.react';\n\nexport default class OncoPrint extends Component {\n    constructor(props) {\n        super(props);\n        this.handleChange = this.handleChange.bind(this);\n    }\n\n    // Bind to Dash event handler that puts event back into props\n    handleChange(event) {\n        const eventObj = JSON.stringify(event);\n        this.props.setProps({eventDatum: eventObj});\n    }\n\n    render() {\n        const {id, eventDatum} = this.props;\n\n        return (\n            <div id={id} eventDatum={eventDatum}>\n                <PreOncoPrint\n                    onChange={this.handleChange}\n                    {...omit(['setProps'], this.props)}\n                />\n            </div>\n        );\n    }\n}\n\nOncoPrint.defaultProps = defaultProps;\nOncoPrint.propTypes = propTypes;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"OncoPrint\", {\n  enumerable: true,\n  get: function get() {\n    return _OncoPrint.default;\n  }\n});\n\nvar _OncoPrint = _interopRequireDefault(require(\"./components/OncoPrint\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _reactPlotly = _interopRequireDefault(require(\"react-plotly.js\"));\n\nvar _utils = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\n * The OncoPrint component is used to view multiple genetic alteration events\n * through an interactive and zoomable heatmap. It is a React/Dash port of the\n * popular oncoPrint() function from the BioConductor R package.\n * Under the hood, the rendering is done using Plotly.js built upon D3.\n * Plotly's interactivity allows the user to bind clicks and hovers to genetic\n * events, allowing the user to create complex bioinformatic apps or workflows\n * that rely on crossfiltering.\n * Read more about the component here:\n * https://github.com/plotly/react-oncoprint\n */\nvar OncoPrint =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(OncoPrint, _PureComponent);\n\n  // Constructor\n  function OncoPrint(props) {\n    var _this;\n\n    _classCallCheck(this, OncoPrint);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(OncoPrint).call(this, props));\n    _this.state = {\n      xStart: null,\n      xEnd: null\n    };\n    _this.resetWindowing = _this.resetWindowing.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleChange = _lodash.default.debounce(_this.handleChange.bind(_assertThisInitialized(_assertThisInitialized(_this))), 250);\n    return _this;\n  } // Reset windowing to user preset on init or data change\n\n\n  _createClass(OncoPrint, [{\n    key: \"resetWindowing\",\n    value: function resetWindowing(props) {\n      var range = props.range;\n      var xStart, xEnd;\n\n      if (range.length === 2) {\n        xStart = range[0];\n        xEnd = range[1];\n      } else {\n        xStart = null;\n        xEnd = null;\n      }\n\n      return {\n        xStart: xStart,\n        xEnd: xEnd\n      };\n    } // Handle plot events\n\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(event) {\n      if (!this.props.onChange) {\n        return;\n      } // CLick (mousedown) or hover (mousemove)\n\n\n      if (event.points) {\n        var eventType;\n\n        if (event.event.type === \"mousedown\") {\n          eventType = 'Click';\n        } else if (event.event.type === \"mousemove\") {\n          eventType = 'Hover';\n        } else {\n          eventType = 'Other';\n        }\n\n        this.props.onChange({\n          eventType: eventType,\n          name: event.points[0].data.name,\n          text: event.points[0].text,\n          curveNumber: event.points[0].curveNumber,\n          x: event.points[0].x,\n          y: event.points[0].y\n        });\n      } // Zoom\n      else if (event['xaxis.range[0]'] || event['xaxis.range']) {\n          this.setState({\n            xStart: event['xaxis.range[0]'] || event['xaxis.range'][0],\n            xEnd: event['xaxis.range[1]'] || event['xaxis.range'][1]\n          });\n          this.props.onChange({\n            eventType: 'Zoom',\n            xStart: event['xaxis.range[0]'] || event['xaxis.range'][0],\n            xEnd: event['xaxis.range[1]'] || event['xaxis.range'][1]\n          });\n        } // Autozoom\n        else if (event['xaxis.autorange'] === true) {\n            this.setState({\n              xStart: null,\n              xEnd: null\n            });\n            this.props.onChange({\n              eventType: 'Autoscale'\n            });\n          } // Guard\n          else {\n              this.props.onChange(event);\n            }\n    }\n  }, {\n    key: \"getData\",\n    // Fetch data\n    value: function getData() {\n      var _this$props = this.props,\n          inputData = _this$props.data,\n          padding = _this$props.padding,\n          colorscale = _this$props.colorscale,\n          backgroundcolor = _this$props.backgroundcolor; // OncoPrint equivalent of x, y\n\n      var events = (0, _utils.aggregate)(inputData);\n      var genes = (0, _utils.getSortedGenes)(inputData);\n      var samples = (0, _utils.getSortedSamples)(inputData);\n      var ratios = (0, _utils.getEventRatiosPerGene)(inputData, samples.length);\n\n      var formatGenes = function formatGenes(list) {\n        return list.map(function (gene) {\n          return \"\".concat(gene, \" (\").concat(ratios[gene], \"%)\");\n        });\n      };\n\n      var base = 0;\n      var bBackground = [];\n      var tBackground = [];\n      var xBackground = [];\n      var yBackground = []; // Background is used to draw the matrix (genes * samples)\n\n      samples.forEach(function (s) {\n        bBackground.push.apply(bBackground, _toConsumableArray(Array(genes.length).fill(base)));\n        tBackground.push.apply(tBackground, _toConsumableArray(Array(genes.length).fill(s)));\n        xBackground.push.apply(xBackground, _toConsumableArray(Array(genes.length).fill(1)));\n        yBackground.push.apply(yBackground, _toConsumableArray(formatGenes(genes)));\n        base += 1;\n      });\n      var background = {\n        base: bBackground.map(function (i) {\n          return i + padding;\n        }),\n        hoverinfo: 'text',\n        marker: {\n          color: backgroundcolor\n        },\n        name: 'No alteration',\n        text: tBackground,\n        orientation: 'h',\n        type: 'bar',\n        x: xBackground.map(function (i) {\n          return i - padding * 2;\n        }),\n        y: yBackground\n      };\n      var data = [background];\n      Object.keys(events).forEach(function (key) {\n        var aggr = events[key]; // Resize width depending on the mutation type\n\n        var width = 0.4;\n\n        if (aggr.type === 'CNA') {\n          width = 0.8;\n        } else if (aggr.type === 'EXP') {\n          width = 0.6;\n        } // Mutations should have the original text on it, not the type of mutation\n\n\n        var text_arr = aggr.events.map(function (event) {\n          return \"\".concat(event.sample, \"<br>\").concat((0, _utils.getDisplayName)(event));\n        }); // where to draw a bar for this entry\n\n        var indexes = aggr.events.map(function (e) {\n          return e.sample;\n        }).map(function (s) {\n          return samples.findIndex(function (sample) {\n            return sample === s;\n          });\n        });\n        data.push({\n          base: indexes.map(function (i) {\n            return i + padding;\n          }),\n          hoverinfo: 'text',\n          marker: {\n            color: (0, _utils.getColor)(aggr.events[0], colorscale)\n          },\n          name: (0, _utils.getDisplayName)(aggr.events[0]),\n          text: text_arr,\n          orientation: 'h',\n          type: 'bar',\n          width: width,\n          x: Array(aggr.events.length).fill(1).map(function (i) {\n            return i - padding * 2;\n          }),\n          y: formatGenes((0, _utils.getGeneNames)(aggr.events))\n        });\n      });\n      return data;\n    } // Fetch layout\n\n  }, {\n    key: \"getLayout\",\n    value: function getLayout() {\n      var _this$props2 = this.props,\n          showlegend = _this$props2.showlegend,\n          showoverview = _this$props2.showoverview,\n          width = _this$props2.width,\n          height = _this$props2.height;\n      var _this$state = this.state,\n          xStart = _this$state.xStart,\n          xEnd = _this$state.xEnd; // Get initial range\n\n      var initialRange = [xStart, xEnd];\n      var layout = {\n        barmode: 'stack',\n        hovermode: 'closest',\n        showlegend: showlegend,\n        xaxis: {\n          showgrid: false,\n          showticklabels: false,\n          zeroline: false,\n          range: initialRange,\n          automargin: true\n        },\n        yaxis: {\n          showgrid: false,\n          zeroline: false,\n          fixedrange: true,\n          automargin: true\n        },\n        margin: {\n          t: 20,\n          r: 20,\n          b: 20\n        }\n      };\n\n      if (showoverview) {\n        layout.xaxis.rangeslider = {\n          autorange: true\n        };\n      }\n\n      return {\n        layout: layout,\n        width: width,\n        height: height\n      };\n    } // Set xStart and xEnd on load\n\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$resetWindowing = this.resetWindowing(this.props),\n          xStart = _this$resetWindowing.xStart,\n          xEnd = _this$resetWindowing.xEnd;\n\n      this.setState({\n        xStart: xStart,\n        xEnd: xEnd\n      });\n    } // Reset xStart and xEnd on data change\n\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.data !== prevProps.data) {\n        var _this$resetWindowing2 = this.resetWindowing(this.props),\n            xStart = _this$resetWindowing2.xStart,\n            xEnd = _this$resetWindowing2.xEnd;\n\n        this.setState({\n          xStart: xStart,\n          xEnd: xEnd\n        });\n      }\n    } // Main\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var data = this.getData();\n\n      var _this$getLayout = this.getLayout(),\n          layout = _this$getLayout.layout,\n          width = _this$getLayout.width,\n          height = _this$getLayout.height;\n\n      var other = {\n        style: {\n          width: width,\n          height: height\n        },\n        useResizeHandler: true\n      };\n      return _react.default.createElement(\"div\", null, _react.default.createElement(_reactPlotly.default, _extends({\n        data: data,\n        layout: layout,\n        onClick: this.handleChange,\n        onHover: this.handleChange,\n        onRelayout: this.handleChange\n      }, other)));\n    }\n  }]);\n\n  return OncoPrint;\n}(_react.PureComponent);\n\nexports.default = OncoPrint;\nOncoPrint.propTypes = {\n  /**\n   * Input data, in CBioPortal format where each list entry is a dict\n   * consisting of 'sample', 'gene', 'alteration', and 'type'\n   */\n  data: _propTypes.default.array,\n  // TODO: Add remove empty columns prop\n\n  /**\n   * Adjusts the padding (as a proportion of whitespace) between two tracks.\n   * Value is a ratio between 0 and 1.\n   * Defaults to 0.05 (e.g. 5%). If set to 0, plot will look like a heatmap.\n   */\n  padding: _propTypes.default.number,\n\n  /**\n   * If not null, will override the default OncoPrint colorscale.\n   * Default OncoPrint colorscale same as CBioPortal implementation.\n   * Make your own colrscale as a {'mutation': COLOR} dict.\n   * Supported mutation keys are ['MISSENSE, 'INFRAME', 'FUSION',\n   * 'AMP', 'GAIN', 'HETLOSS', 'HMODEL', 'UP', 'DOWN']\n   * Note that this is NOT a standard plotly colorscale.\n   */\n  colorscale: _propTypes.default.oneOfType([_propTypes.default.bool, _propTypes.default.object]),\n\n  /**\n   * Default color for the tracks, in common name, hex, rgb or rgba format.\n   * If left blank, will default to a light grey rgb(190, 190, 190).\n   */\n  backgroundcolor: _propTypes.default.string,\n\n  /**\n   *.Toogles whether or not to show a legend on the right side of the plot,\n   * with mutation information.\n   */\n  range: _propTypes.default.array,\n\n  /**\n   *.Toogles whether or not to show a legend on the right side of the plot,\n   * with mutation information.\n   */\n  showlegend: _propTypes.default.bool,\n\n  /**\n   *.Toogles whether or not to show a heatmap overview of the tracks.\n   */\n  showoverview: _propTypes.default.bool,\n\n  /**\n   * Width of the OncoPrint.\n   * Will disable auto-resizing of plots if set.\n   */\n  width: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string]),\n\n  /**\n   * Height of the OncoPrint.\n   * Will disable auto-resizing of plots if set.\n   */\n  height: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string])\n};\nOncoPrint.defaultProps = {\n  // Data\n  padding: 0.05,\n  colorscale: null,\n  backgroundcolor: 'rgb(190, 190, 190)',\n  // Layout\n  range: [null, null],\n  showlegend: true,\n  showoverview: true,\n  // Other\n  width: null,\n  height: 500\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getColor = exports.getDisplayName = exports.aggregate = exports.getSortedSamples = exports.createSortEventsForGeneComparator = exports.createSamplesMap = exports.isMutation = exports.getEventRatiosPerGene = exports.getSortedGenes = exports.getGeneNames = exports.SupportedEvents = void 0;\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _PrecomputedComparator = _interopRequireDefault(require(\"./PrecomputedComparator\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nvar MutationEventTypes = ['INFRAME', 'TRUNC', 'MISSENSE'];\nvar SupportedEvents = {\n  // Mutations\n  MISSENSE: {\n    colorHTML: '#008000',\n    displayName: 'Missense mutation'\n  },\n  INFRAME: {\n    colorHTML: '#993404',\n    displayName: 'Inframe mutation'\n  },\n  TRUNC: {\n    colorHTML: '#000000',\n    displayName: 'Truncation mutation'\n  },\n  // Fusion\n  FUSION: {\n    colorHTML: '#8b00c9',\n    displayName: 'Fusion'\n  },\n  // Copy number alterations\n  AMP: {\n    colorHTML: '#ff0000',\n    displayName: 'Amplification'\n  },\n  GAIN: {\n    colorHTML: '#ffb6c1',\n    displayName: 'Gain'\n  },\n  HETLOSS: {\n    colorHTML: '#8fd8d8',\n    displayName: 'Shallow deletion'\n  },\n  HOMDEL: {\n    colorHTML: '#0000ff',\n    displayName: 'Deep deletion'\n  },\n  // mRNA expressions\n  UP: {\n    colorHTML: '#ff9999',\n    displayName: 'mRNA Upregulation'\n  },\n  DOWN: {\n    colorHTML: '#6699cc',\n    displayName: 'mRNA Downregulation'\n  }\n}; // Describes the order of importance for CNA events.\n\nexports.SupportedEvents = SupportedEvents;\nvar AlterationsOrder = {\n  AMP: 0,\n  GAIN: 2,\n  HETLOSS: 3,\n  HOMDEL: 1,\n  undefined: 4\n}; // Describes the order of importance for mutation events.\n\nvar MutationsOrder = {\n  INFRAME: 1,\n  MISSENSE: 3,\n  TRUNC: 0,\n  undefined: 4\n}; // Describes the order of importance for mRNA expression events.\n\nvar ExpressionsOrder = {\n  UP: 0,\n  DOWN: 1,\n  undefined: 2\n}; // Retrieves the gene names in a set of events.\n\nvar getGeneNames = function getGeneNames(events) {\n  return events.map(function (e) {\n    return e.gene;\n  }).filter(function (gene) {\n    return gene !== null;\n  });\n}; // Returns the set of genes (unique) reversed to display on the Y axis.\n\n\nexports.getGeneNames = getGeneNames;\n\nvar getSortedGenes = function getSortedGenes(events) {\n  return _toConsumableArray(new Set(getGeneNames(events))).reverse();\n}; // Returns a hash map with the percentage of events (value) per gene (key).\n\n\nexports.getSortedGenes = getSortedGenes;\n\nvar getEventRatiosPerGene = function getEventRatiosPerGene(events, nbSamples) {\n  var map = events.reduce(function (acc, event) {\n    if (event.type) {\n      if (acc[event.gene]) {\n        acc[event.gene] += 1;\n      } else {\n        acc[event.gene] = 1;\n      }\n    }\n\n    return acc;\n  }, {});\n  Object.keys(map).forEach(function (gene) {\n    map[gene] = Math.floor(map[gene] / nbSamples * 100);\n  });\n  return map;\n}; // Returns true if an event is a mutation, false otherwise.\n\n\nexports.getEventRatiosPerGene = getEventRatiosPerGene;\n\nvar isMutation = function isMutation(event) {\n  return MutationEventTypes.includes(event.type);\n}; // Returns a comparator result value given an integer that may not be -1, 0 or\n// 1 (which are the only allowed sorting return values).\n\n\nexports.isMutation = isMutation;\n\nvar sign = function sign(x) {\n  if (x > 0) {\n    return 1;\n  } else if (x < 0) {\n    return -1;\n  }\n\n  return 0;\n}; // Returns a comparator for the samples (matrix column), combining all the\n// precomputed comparators created for each gene (i.e. matrix row).\n\n\nvar samplesComparator = function samplesComparator(genes, samplesToIndex, perGeneComparators) {\n  return function (s1, s2) {\n    var result = 0;\n    var absoluteResult = 0;\n\n    for (var i = 0; i < genes.length; i += 1) {\n      var nextResult = perGeneComparators[i].compare(s1, s2);\n      var nextAbsoluteResult = Math.abs(nextResult);\n\n      if (nextAbsoluteResult > absoluteResult) {\n        result = nextResult;\n        absoluteResult = nextAbsoluteResult;\n      }\n\n      if (absoluteResult === 1) {\n        break;\n      }\n    }\n\n    if (result === 0) {\n      result = samplesToIndex[s1] < samplesToIndex[s2] ? -1 : 1;\n    }\n\n    return result > 0 ? 1 : -1;\n  };\n}; // Returns a comparator to sort the samples given a gene .\n\n\nvar sortEventsForGene = function sortEventsForGene(s1, s2, gene, samplesMap) {\n  var d1 = samplesMap[s1][gene] || {};\n  var d2 = samplesMap[s2][gene] || {};\n\n  if (d1.FUSION && !d2.FUSION) {\n    return -1;\n  } else if (!d1.FUSION && d2.FUSION) {\n    return 1;\n  }\n\n  var cna = sign(AlterationsOrder[d1.CNA] - AlterationsOrder[d2.CNA]);\n\n  if (cna !== 0) {\n    return cna;\n  }\n\n  var mut = sign(MutationsOrder[d1.MUT] - MutationsOrder[d2.MUT]);\n\n  if (mut !== 0) {\n    return mut;\n  }\n\n  var exp = sign(ExpressionsOrder[d1.EXP] - ExpressionsOrder[d2.EXP]);\n\n  if (exp !== 0) {\n    return exp;\n  }\n\n  return 0;\n}; // Returns a map to gather information on each sample, per gene, per event.\n\n\nvar createSamplesMap = function createSamplesMap(events) {\n  var samplesMap = {};\n  events.forEach(function (e) {\n    var s = samplesMap[e.sample] || {};\n    var v = s[e.gene] || {};\n\n    if (isMutation(e)) {\n      v.MUT = e.type;\n    } else {\n      v[e.type] = e.alteration;\n    }\n\n    samplesMap[e.sample] = Object.assign({}, samplesMap[e.sample], _defineProperty({}, e.gene, v));\n  });\n  return samplesMap;\n}; // Helper function to create a comparator for each gene.\n\n\nexports.createSamplesMap = createSamplesMap;\n\nvar createSortEventsForGeneComparator = function createSortEventsForGeneComparator(gene, map) {\n  return function (s1, s2) {\n    return sortEventsForGene(s1, s2, gene, map);\n  };\n}; // Returns the list of samples sorted with mutual exclusion. The sorting\n// algorithm is similar to the one used on cBioPortal and takes both the rows\n// (genes) and columns (samples) into account. We returns the sorted set of\n// samples to display on X axix.\n\n\nexports.createSortEventsForGeneComparator = createSortEventsForGeneComparator;\n\nvar getSortedSamples = function getSortedSamples(events) {\n  // Get a map with samples sorted by gene and events.\n  var samplesMap = createSamplesMap(events); // Get a unique list of genes, sorted by the natural order in the events.\n\n  var genes = _toConsumableArray(new Set(getGeneNames(events))); // Sort the samples alphabetically.\n\n\n  var samples = _toConsumableArray(new Set(events.map(function (e) {\n    return e.sample;\n  }))).sort(); // Build one comparator per gene.\n\n\n  var perGeneComparators = [];\n  genes.forEach(function (gene) {\n    perGeneComparators.push( // This actually sorts the samples, but for each gene only.\n    new _PrecomputedComparator.default(_toConsumableArray(samples), createSortEventsForGeneComparator(gene, samplesMap)));\n  }); // Create a map with the current order of the samples.\n\n  var samplesToIndex = {};\n  samples.forEach(function (s, i) {\n    samplesToIndex[s] = i;\n  }); // Finally, sort the samples taking into account both the columns and rows.\n\n  var sortedSamples = _toConsumableArray(samples);\n\n  sortedSamples.sort(samplesComparator(genes, samplesToIndex, perGeneComparators));\n  return sortedSamples;\n}; // Returns the events aggregated by type (if mutation) or alteration.\n\n\nexports.getSortedSamples = getSortedSamples;\n\nvar aggregate = function aggregate(events) {\n  var out = {};\n  events.forEach(function (e) {\n    if (!e.type || e.type === 'NONE') {\n      return;\n    }\n\n    var k = isMutation(e) ? e.type : e.alteration;\n    var v = out[k] || {\n      type: e.type,\n      alteration: e.alteration,\n      events: []\n    };\n    v.events.push(e);\n    out[k] = v;\n  });\n  return out;\n}; // Returns the display name of an event.\n\n\nexports.aggregate = aggregate;\n\nvar getDisplayName = function getDisplayName(event) {\n  var eventName = isMutation(event) ? event.type : event.alteration;\n  return SupportedEvents[eventName].displayName;\n}; // Returns the color of an event.\n\n\nexports.getDisplayName = getDisplayName;\n\nvar getColor = function getColor(event, colorscale) {\n  var eventName = isMutation(event) ? event.type : event.alteration;\n  var color;\n\n  if (colorscale && _lodash.default.isObject(colorscale)) {\n    color = colorscale[eventName]; // Revert back to default scale if not found\n\n    if (!color) {\n      color = SupportedEvents[eventName].colorHTML;\n    }\n  } else {\n    color = SupportedEvents[eventName].colorHTML;\n  }\n\n  return color;\n};\n\nexports.getColor = getColor;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.hasElementsInInterval = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar hasElementsInInterval = function hasElementsInInterval(arr, func, lowerBound, upperBound) {\n  // in: arr, an array sorted in increasing order of func\n  //     func, a function that takes an element of sorted_list and returns a number\n  //     lowerBound and upperBound: define a half-open interval [lowerBound, upperBound)\n  // out: boolean, true iff there are any elements whose image under func is in [lowerBound, upperBound)\n  var lowerCounter = 0;\n  var upperCounter = arr.length;\n  var middle, middle_val;\n\n  while (true) {\n    if (lowerCounter >= upperCounter) {\n      return false;\n    }\n\n    middle = Math.floor((lowerCounter + upperCounter) / 2);\n    middle_val = func(arr[middle]);\n\n    if (middle_val >= upperBound) {\n      upperCounter = middle;\n    } else if (middle_val < lowerBound) {\n      lowerCounter = middle + 1;\n    } else {\n      // otherwise, the middle value is inside the interval,\n      // so there's at least one value inside the interval\n      return true;\n    }\n  }\n}; // PrecomputedComparator is similar to the OncoPrintJs implementation with\n// three notable changes: rewritten with Flow/ES next and as a class, the input\n// data structure is different, and no direction.\n\n\nexports.hasElementsInInterval = hasElementsInInterval;\n\nvar PrecomputedComparator =\n/*#__PURE__*/\nfunction () {\n  function PrecomputedComparator(data, comparator) {\n    _classCallCheck(this, PrecomputedComparator);\n\n    this.comparator = comparator;\n    this.data = data;\n    this.sort();\n  }\n\n  _createClass(PrecomputedComparator, [{\n    key: \"sort\",\n    value: function sort() {\n      this.sortedData = this.data.sort(this.comparator);\n      this.changePoints = [];\n\n      for (var i = 0; i < this.sortedData.length; i += 1) {\n        if (i === this.sortedData.length - 1) {\n          break;\n        }\n\n        if (this.comparator(this.sortedData[i], this.sortedData[i + 1]) !== 0) {\n          this.changePoints.push(i);\n        }\n      }\n\n      this.samplesToIndex = {};\n\n      for (var _i = 0; _i < this.sortedData.length; _i += 1) {\n        this.samplesToIndex[this.sortedData[_i]] = _i;\n      }\n    }\n  }, {\n    key: \"compare\",\n    value: function compare(s1, s2) {\n      var i1 = this.samplesToIndex[s1];\n      var i2 = this.samplesToIndex[s2];\n\n      if (typeof i1 === 'undefined' && typeof i2 === 'undefined') {\n        return 0;\n      } else if (typeof i1 === 'undefined') {\n        return 1;\n      } else if (typeof i2 === 'undefined') {\n        return -1;\n      }\n\n      var shouldNegateResult = false;\n\n      if (i1 === i2) {\n        return 0;\n      } else if (i1 > i2) {\n        var tmp = i1;\n        i1 = i2;\n        i2 = tmp;\n        shouldNegateResult = true;\n      }\n\n      var res = 0;\n\n      if (hasElementsInInterval(this.changePoints, function (x) {\n        return x;\n      }, i1, i2)) {\n        res = -1;\n      }\n\n      if (shouldNegateResult) {\n        res *= -1;\n      }\n\n      return res;\n    }\n  }]);\n\n  return PrecomputedComparator;\n}();\n\nexports.default = PrecomputedComparator;"],"sourceRoot":""}