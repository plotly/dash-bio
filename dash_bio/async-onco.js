"use strict";(self.webpackChunkdash_bio=self.webpackChunkdash_bio||[]).push([[881],{8608:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var r=n(9196),o=n.n(r),a=n(7584),i=n(4503),u=n(8078);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,"symbol"==typeof(o=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key))?o:String(o)),r)}var o}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(y,e);var t,n,r,u,h=(r=y,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(u){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=h.call(this,e)).handleChange=t.handleChange.bind(p(t)),t}return t=y,(n=[{key:"handleChange",value:function(e){var t=JSON.stringify(e);this.props.setProps({eventDatum:t})}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.eventDatum,r=e.loading_state;return o().createElement("div",{id:t,eventDatum:n,"data-dash-is-loading":r&&r.is_loading||void 0},o().createElement(i.$,l({onChange:this.handleChange},(0,a.Z)(["setProps","loading_state"],this.props))))}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(r.Component);h.defaultProps=u.lG,h.propTypes=u.iG},3830:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(9196)),o=l(n(5697)),a=l(n(6486)),i=l(n(8660)),u=n(770);function l(e){return e&&e.__esModule?e:{default:e}}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function f(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var v=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?y(e):t}(this,d(t).call(this,e))).state={xStart:null,xEnd:null},n.resetWindowing=n.resetWindowing.bind(y(y(n))),n.handleChange=a.default.debounce(n.handleChange.bind(y(y(n))),250),n}var n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),n=t,(o=[{key:"resetWindowing",value:function(e){var t,n,r=e.range;return 2===r.length?(t=r[0],n=r[1]):(t=null,n=null),{xStart:t,xEnd:n}}},{key:"handleChange",value:function(e){var t;this.props.onChange&&(e.points?(t="mousedown"===e.event.type?"Click":"mousemove"===e.event.type?"Hover":"Other",this.props.onChange({eventType:t,name:e.points[0].data.name,text:e.points[0].text,curveNumber:e.points[0].curveNumber,x:e.points[0].x,y:e.points[0].y})):e["xaxis.range[0]"]||e["xaxis.range"]?(this.setState({xStart:e["xaxis.range[0]"]||e["xaxis.range"][0],xEnd:e["xaxis.range[1]"]||e["xaxis.range"][1]}),this.props.onChange({eventType:"Zoom",xStart:e["xaxis.range[0]"]||e["xaxis.range"][0],xEnd:e["xaxis.range[1]"]||e["xaxis.range"][1]})):!0===e["xaxis.autorange"]?(this.setState({xStart:null,xEnd:null}),this.props.onChange({eventType:"Autoscale"})):this.props.onChange(e))}},{key:"getData",value:function(){var e=this.props,t=e.data,n=e.padding,r=e.colorscale,o=e.backgroundcolor,a=(0,u.aggregate)(t),i=(0,u.getSortedGenes)(t),l=(0,u.getSortedSamples)(t),s=(0,u.getEventRatiosPerGene)(t,l.length),c=function(e){return e.map((function(e){return"".concat(e," (").concat(s[e],"%)")}))},p=0,d=[],h=[],y=[],v=[];l.forEach((function(e){d.push.apply(d,f(Array(i.length).fill(p))),h.push.apply(h,f(Array(i.length).fill(e))),y.push.apply(y,f(Array(i.length).fill(1))),v.push.apply(v,f(c(i))),p+=1}));var g=[{base:d.map((function(e){return e+n})),hoverinfo:"text",marker:{color:o},name:"No alteration",text:h,orientation:"h",type:"bar",x:y.map((function(e){return e-2*n})),y:v}];return Object.keys(a).forEach((function(e){var t=a[e],o=.4;"CNA"===t.type?o=.8:"EXP"===t.type&&(o=.6);var i=t.events.map((function(e){return"".concat(e.sample,"<br>").concat((0,u.getDisplayName)(e))})),s=t.events.map((function(e){return e.sample})).map((function(e){return l.findIndex((function(t){return t===e}))}));g.push({base:s.map((function(e){return e+n})),hoverinfo:"text",marker:{color:(0,u.getColor)(t.events[0],r)},name:(0,u.getDisplayName)(t.events[0]),text:i,orientation:"h",type:"bar",width:o,x:Array(t.events.length).fill(1).map((function(e){return e-2*n})),y:c((0,u.getGeneNames)(t.events))})})),g}},{key:"getLayout",value:function(){var e=this.props,t=e.showlegend,n=e.showoverview,r=e.width,o=e.height,a=this.state,i={barmode:"stack",hovermode:"closest",showlegend:t,xaxis:{showgrid:!1,showticklabels:!1,zeroline:!1,range:[a.xStart,a.xEnd],automargin:!0},yaxis:{showgrid:!1,zeroline:!1,fixedrange:!0,automargin:!0},margin:{t:20,r:20,b:20}};return n&&(i.xaxis.rangeslider={autorange:!0}),{layout:i,width:r,height:o}}},{key:"componentDidMount",value:function(){var e=this.resetWindowing(this.props),t=e.xStart,n=e.xEnd;this.setState({xStart:t,xEnd:n})}},{key:"componentDidUpdate",value:function(e,t){if(this.props.data!==e.data){var n=this.resetWindowing(this.props),r=n.xStart,o=n.xEnd;this.setState({xStart:r,xEnd:o})}}},{key:"render",value:function(){var e=this.getData(),t=this.getLayout(),n=t.layout,o={style:{width:t.width,height:t.height},useResizeHandler:!0};return r.default.createElement("div",null,r.default.createElement(i.default,c({data:e,layout:n,onClick:this.handleChange,onHover:this.handleChange,onRelayout:this.handleChange},o)))}}])&&p(n.prototype,o),t}(r.PureComponent);t.default=v,v.propTypes={data:o.default.array,padding:o.default.number,colorscale:o.default.oneOfType([o.default.bool,o.default.object]),backgroundcolor:o.default.string,range:o.default.array,showlegend:o.default.bool,showoverview:o.default.bool,width:o.default.oneOfType([o.default.number,o.default.string]),height:o.default.oneOfType([o.default.number,o.default.string])},v.defaultProps={padding:.05,colorscale:null,backgroundcolor:"rgb(190, 190, 190)",range:[null,null],showlegend:!0,showoverview:!0,width:null,height:500}},2159:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.hasElementsInInterval=void 0;var r=function(e,t,n,r){for(var o,a,i=0,u=e.length;;){if(i>=u)return!1;if((a=t(e[o=Math.floor((i+u)/2)]))>=r)u=o;else{if(!(a<n))return!0;i=o+1}}};t.hasElementsInInterval=r;var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.comparator=n,this.data=t,this.sort()}var t,o;return t=e,(o=[{key:"sort",value:function(){this.sortedData=this.data.sort(this.comparator),this.changePoints=[];for(var e=0;e<this.sortedData.length&&e!==this.sortedData.length-1;e+=1)0!==this.comparator(this.sortedData[e],this.sortedData[e+1])&&this.changePoints.push(e);this.samplesToIndex={};for(var t=0;t<this.sortedData.length;t+=1)this.samplesToIndex[this.sortedData[t]]=t}},{key:"compare",value:function(e,t){var n=this.samplesToIndex[e],o=this.samplesToIndex[t];if(void 0===n&&void 0===o)return 0;if(void 0===n)return 1;if(void 0===o)return-1;var a=!1;if(n===o)return 0;if(n>o){var i=n;n=o,o=i,a=!0}var u=0;return r(this.changePoints,(function(e){return e}),n,o)&&(u=-1),a&&(u*=-1),u}}])&&n(t.prototype,o),e}();t.default=o},770:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getColor=t.getDisplayName=t.aggregate=t.getSortedSamples=t.createSortEventsForGeneComparator=t.createSamplesMap=t.isMutation=t.getEventRatiosPerGene=t.getSortedGenes=t.getGeneNames=t.SupportedEvents=void 0;var r=a(n(6486)),o=a(n(2159));function a(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var u=["INFRAME","TRUNC","MISSENSE"],l={MISSENSE:{colorHTML:"#008000",displayName:"Missense mutation"},INFRAME:{colorHTML:"#993404",displayName:"Inframe mutation"},TRUNC:{colorHTML:"#000000",displayName:"Truncation mutation"},FUSION:{colorHTML:"#8b00c9",displayName:"Fusion"},AMP:{colorHTML:"#ff0000",displayName:"Amplification"},GAIN:{colorHTML:"#ffb6c1",displayName:"Gain"},HETLOSS:{colorHTML:"#8fd8d8",displayName:"Shallow deletion"},HOMDEL:{colorHTML:"#0000ff",displayName:"Deep deletion"},UP:{colorHTML:"#ff9999",displayName:"mRNA Upregulation"},DOWN:{colorHTML:"#6699cc",displayName:"mRNA Downregulation"}};t.SupportedEvents=l;var s={AMP:0,GAIN:2,HETLOSS:3,HOMDEL:1,undefined:4},c={INFRAME:1,MISSENSE:3,TRUNC:0,undefined:4},f={UP:0,DOWN:1,undefined:2},p=function(e){return e.map((function(e){return e.gene})).filter((function(e){return null!==e}))};t.getGeneNames=p,t.getSortedGenes=function(e){return i(new Set(p(e))).reverse()},t.getEventRatiosPerGene=function(e,t){var n=e.reduce((function(e,t){return t.type&&(e[t.gene]?e[t.gene]+=1:e[t.gene]=1),e}),{});return Object.keys(n).forEach((function(e){n[e]=Math.floor(n[e]/t*100)})),n};var d=function(e){return u.includes(e.type)};t.isMutation=d;var h=function(e){return e>0?1:e<0?-1:0},y=function(e){var t={};return e.forEach((function(e){var n,r,o,a=(t[e.sample]||{})[e.gene]||{};d(e)?a.MUT=e.type:a[e.type]=e.alteration,t[e.sample]=Object.assign({},t[e.sample],(n={},o=a,(r=e.gene)in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n))})),t};t.createSamplesMap=y;var v=function(e,t){return function(n,r){return function(e,t,n,r){var o=r[e][n]||{},a=r[t][n]||{};if(o.FUSION&&!a.FUSION)return-1;if(!o.FUSION&&a.FUSION)return 1;var i=h(s[o.CNA]-s[a.CNA]);if(0!==i)return i;var u=h(c[o.MUT]-c[a.MUT]);if(0!==u)return u;var l=h(f[o.EXP]-f[a.EXP]);return 0!==l?l:0}(n,r,e,t)}};t.createSortEventsForGeneComparator=v,t.getSortedSamples=function(e){var t=y(e),n=i(new Set(p(e))),r=i(new Set(e.map((function(e){return e.sample})))).sort(),a=[];n.forEach((function(e){a.push(new o.default(i(r),v(e,t)))}));var u={};r.forEach((function(e,t){u[e]=t}));var l=i(r);return l.sort(function(e,t,n){return function(r,o){for(var a=0,i=0,u=0;u<e.length;u+=1){var l=n[u].compare(r,o),s=Math.abs(l);if(s>i&&(a=l,i=s),1===i)break}return 0===a&&(a=t[r]<t[o]?-1:1),a>0?1:-1}}(n,u,a)),l},t.aggregate=function(e){var t={};return e.forEach((function(e){if(e.type&&"NONE"!==e.type){var n=d(e)?e.type:e.alteration,r=t[n]||{type:e.type,alteration:e.alteration,events:[]};r.events.push(e),t[n]=r}})),t},t.getDisplayName=function(e){var t=d(e)?e.type:e.alteration;return l[t].displayName},t.getColor=function(e,t){var n,o=d(e)?e.type:e.alteration;return t&&r.default.isObject(t)&&(n=t[o])||(n=l[o].colorHTML),n}},4503:function(e,t,n){Object.defineProperty(t,"$",{enumerable:!0,get:function(){return o.default}});var r,o=(r=n(3830))&&r.__esModule?r:{default:r}}}]);
//# sourceMappingURL=async-onco.js.map