{"version":3,"sources":["webpack:///./node_modules/ramda/es/internal/_isNumber.js","webpack:///./node_modules/ramda/es/range.js","webpack:///./node_modules/ramda/es/always.js","webpack:///./node_modules/ramda/es/times.js","webpack:///./node_modules/ramda/es/repeat.js","webpack:///./node_modules/ramda/es/internal/_curry3.js","webpack:///./node_modules/ramda/es/internal/_isArray.js","webpack:///./node_modules/ramda/es/internal/_isArrayLike.js","webpack:///./node_modules/ramda/es/internal/_isString.js","webpack:///./node_modules/ramda/es/internal/_xwrap.js","webpack:///./node_modules/ramda/es/bind.js","webpack:///./node_modules/ramda/es/internal/_arity.js","webpack:///./node_modules/ramda/es/internal/_reduce.js","webpack:///./node_modules/ramda/es/reduce.js","webpack:///./node_modules/ramda/es/max.js","webpack:///./node_modules/ramda/es/internal/_isObject.js","webpack:///./node_modules/ramda/es/mergeWithKey.js","webpack:///./node_modules/ramda/es/mergeDeepWithKey.js","webpack:///./node_modules/ramda/es/mergeDeepRight.js","webpack:///./src/lib/fragments/NeedlePlot.react.js"],"names":["_isNumber","x","Object","prototype","toString","call","_curry2","from","to","TypeError","result","n","push","_curry1","val","fn","list","len","Number","idx","isNaN","RangeError","Array","value","_curry3","f3","a","b","c","arguments","length","_isPlaceholder","_b","_c","_a","_isArray","_isString","nodeType","hasOwnProperty","XWrap","this","f","Error","acc","thisObj","apply","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","_arity","_iterableReduce","xf","iter","step","next","done","_methodReduce","obj","methodName","symIterator","Symbol","iterator","_reduce","_xwrap","_arrayReduce","reduce","_isObject","l","r","k","_has","mergeDeepWithKey","lObj","rObj","lVal","rVal","isNumeric","parseFloat","isFinite","createHorizontalLine","xi","y","dx","N","Math","max","range","map","i","repeat","nanMax","test_array","Infinity","filter","el","filterNanArray","NeedlePlot","state","xStart","xEnd","handleChange","bind","props","mergeDeepRight","defaultProps","event","setState","id","prepareTraces","data","globalAnnotation","domainAnnotations","layout","prepareLayout","onRelayout","omit","mutationData","mutationGroups","domains","domainStyle","domainColor","displayMinorDomains","needleStyle","stemColor","stemThickness","stemConstHeight","headSize","headColor","headSymbol","protein_pos_array","positions_array","domains_array","idx_old_positions_array","idx_bogus_entry","forEach","indexOf","domains_limits","split","extractSmallDomains","x_single_site","small_domains","fixed_mutation_colors","isArray","fixed_mutation_symbols","fixed_domain_colors","X_DATA_MIN","min","X_DATA_MAX","Y_DATA_MAX","X_RANGE_MIN","XSPAN","Y_BUFFER","Y_TOP","sequenceDomains","hoverlabels","stemsY","concat","hoverinfo","dom","domainLimits","coord","x0","x1","domainLength","xaxis","name","fill","mode","opacity","visible","legendgroup","marker","color","line_x","line_y","type","fillcolor","hoveron","showlegend","line","width","showarrow","text","align","gname","Set","xref","yref","error_y","symmetric","array","arrayminus","thickness","transforms","groups","nameformat","styles","target","size","symbol","vars","xlabel","ylabel","rangeSlider","first_init","Boolean","trace","legend","orientation","bgcolor","hovermode","title","showgrid","zeroline","autorange","anchor","xaxis2","scaleanchor","overlaying","yaxis","ticks","margin","t","annotations","rangeslider","Component","propTypes"],"mappings":"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","file":"async-needle.js","sourcesContent":["export default function _isNumber(x) {\n  return Object.prototype.toString.call(x) === '[object Number]';\n}","import _curry2 from './internal/_curry2.js';\nimport _isNumber from './internal/_isNumber.js';\n\n/**\n * Returns a list of numbers from `from` (inclusive) to `to` (exclusive).\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig Number -> Number -> [Number]\n * @param {Number} from The first number in the list.\n * @param {Number} to One more than the last number in the list.\n * @return {Array} The list of numbers in the set `[a, b)`.\n * @example\n *\n *      R.range(1, 5);    //=> [1, 2, 3, 4]\n *      R.range(50, 53);  //=> [50, 51, 52]\n */\nvar range = /*#__PURE__*/_curry2(function range(from, to) {\n  if (!(_isNumber(from) && _isNumber(to))) {\n    throw new TypeError('Both arguments to range must be numbers');\n  }\n  var result = [];\n  var n = from;\n  while (n < to) {\n    result.push(n);\n    n += 1;\n  }\n  return result;\n});\nexport default range;","import _curry1 from './internal/_curry1.js';\n\n/**\n * Returns a function that always returns the given value. Note that for\n * non-primitives the value returned is a reference to the original value.\n *\n * This function is known as `const`, `constant`, or `K` (for K combinator) in\n * other languages and libraries.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Function\n * @sig a -> (* -> a)\n * @param {*} val The value to wrap in a function\n * @return {Function} A Function :: * -> val.\n * @example\n *\n *      const t = R.always('Tee');\n *      t(); //=> 'Tee'\n */\nvar always = /*#__PURE__*/_curry1(function always(val) {\n  return function () {\n    return val;\n  };\n});\nexport default always;","import _curry2 from './internal/_curry2.js';\n\n/**\n * Calls an input function `n` times, returning an array containing the results\n * of those function calls.\n *\n * `fn` is passed one argument: The current value of `n`, which begins at `0`\n * and is gradually incremented to `n - 1`.\n *\n * @func\n * @memberOf R\n * @since v0.2.3\n * @category List\n * @sig (Number -> a) -> Number -> [a]\n * @param {Function} fn The function to invoke. Passed one argument, the current value of `n`.\n * @param {Number} n A value between `0` and `n - 1`. Increments after each function call.\n * @return {Array} An array containing the return values of all calls to `fn`.\n * @see R.repeat\n * @example\n *\n *      R.times(R.identity, 5); //=> [0, 1, 2, 3, 4]\n * @symb R.times(f, 0) = []\n * @symb R.times(f, 1) = [f(0)]\n * @symb R.times(f, 2) = [f(0), f(1)]\n */\nvar times = /*#__PURE__*/_curry2(function times(fn, n) {\n  var len = Number(n);\n  var idx = 0;\n  var list;\n\n  if (len < 0 || isNaN(len)) {\n    throw new RangeError('n must be a non-negative number');\n  }\n  list = new Array(len);\n  while (idx < len) {\n    list[idx] = fn(idx);\n    idx += 1;\n  }\n  return list;\n});\nexport default times;","import _curry2 from './internal/_curry2.js';\nimport always from './always.js';\nimport times from './times.js';\n\n/**\n * Returns a fixed list of size `n` containing a specified identical value.\n *\n * @func\n * @memberOf R\n * @since v0.1.1\n * @category List\n * @sig a -> n -> [a]\n * @param {*} value The value to repeat.\n * @param {Number} n The desired size of the output list.\n * @return {Array} A new array containing `n` `value`s.\n * @see R.times\n * @example\n *\n *      R.repeat('hi', 5); //=> ['hi', 'hi', 'hi', 'hi', 'hi']\n *\n *      const obj = {};\n *      const repeatedObjs = R.repeat(obj, 5); //=> [{}, {}, {}, {}, {}]\n *      repeatedObjs[0] === repeatedObjs[1]; //=> true\n * @symb R.repeat(a, 0) = []\n * @symb R.repeat(a, 1) = [a]\n * @symb R.repeat(a, 2) = [a, a]\n */\nvar repeat = /*#__PURE__*/_curry2(function repeat(value, n) {\n  return times(always(value), n);\n});\nexport default repeat;","import _curry1 from './_curry1.js';\nimport _curry2 from './_curry2.js';\nimport _isPlaceholder from './_isPlaceholder.js';\n\n/**\n * Optimized internal three-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\nexport default function _curry3(fn) {\n  return function f3(a, b, c) {\n    switch (arguments.length) {\n      case 0:\n        return f3;\n      case 1:\n        return _isPlaceholder(a) ? f3 : _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        });\n      case 2:\n        return _isPlaceholder(a) && _isPlaceholder(b) ? f3 : _isPlaceholder(a) ? _curry2(function (_a, _c) {\n          return fn(_a, b, _c);\n        }) : _isPlaceholder(b) ? _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        }) : _curry1(function (_c) {\n          return fn(a, b, _c);\n        });\n      default:\n        return _isPlaceholder(a) && _isPlaceholder(b) && _isPlaceholder(c) ? f3 : _isPlaceholder(a) && _isPlaceholder(b) ? _curry2(function (_a, _b) {\n          return fn(_a, _b, c);\n        }) : _isPlaceholder(a) && _isPlaceholder(c) ? _curry2(function (_a, _c) {\n          return fn(_a, b, _c);\n        }) : _isPlaceholder(b) && _isPlaceholder(c) ? _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        }) : _isPlaceholder(a) ? _curry1(function (_a) {\n          return fn(_a, b, c);\n        }) : _isPlaceholder(b) ? _curry1(function (_b) {\n          return fn(a, _b, c);\n        }) : _isPlaceholder(c) ? _curry1(function (_c) {\n          return fn(a, b, _c);\n        }) : fn(a, b, c);\n    }\n  };\n}","/**\n * Tests whether or not an object is an array.\n *\n * @private\n * @param {*} val The object to test.\n * @return {Boolean} `true` if `val` is an array, `false` otherwise.\n * @example\n *\n *      _isArray([]); //=> true\n *      _isArray(null); //=> false\n *      _isArray({}); //=> false\n */\nexport default Array.isArray || function _isArray(val) {\n  return val != null && val.length >= 0 && Object.prototype.toString.call(val) === '[object Array]';\n};","import _curry1 from './_curry1.js';\nimport _isArray from './_isArray.js';\nimport _isString from './_isString.js';\n\n/**\n * Tests whether or not an object is similar to an array.\n *\n * @private\n * @category Type\n * @category List\n * @sig * -> Boolean\n * @param {*} x The object to test.\n * @return {Boolean} `true` if `x` has a numeric length property and extreme indices defined; `false` otherwise.\n * @example\n *\n *      _isArrayLike([]); //=> true\n *      _isArrayLike(true); //=> false\n *      _isArrayLike({}); //=> false\n *      _isArrayLike({length: 10}); //=> false\n *      _isArrayLike({0: 'zero', 9: 'nine', length: 10}); //=> true\n */\nvar _isArrayLike = /*#__PURE__*/_curry1(function isArrayLike(x) {\n  if (_isArray(x)) {\n    return true;\n  }\n  if (!x) {\n    return false;\n  }\n  if (typeof x !== 'object') {\n    return false;\n  }\n  if (_isString(x)) {\n    return false;\n  }\n  if (x.nodeType === 1) {\n    return !!x.length;\n  }\n  if (x.length === 0) {\n    return true;\n  }\n  if (x.length > 0) {\n    return x.hasOwnProperty(0) && x.hasOwnProperty(x.length - 1);\n  }\n  return false;\n});\nexport default _isArrayLike;","export default function _isString(x) {\n  return Object.prototype.toString.call(x) === '[object String]';\n}","var XWrap = /*#__PURE__*/function () {\n  function XWrap(fn) {\n    this.f = fn;\n  }\n  XWrap.prototype['@@transducer/init'] = function () {\n    throw new Error('init not implemented on XWrap');\n  };\n  XWrap.prototype['@@transducer/result'] = function (acc) {\n    return acc;\n  };\n  XWrap.prototype['@@transducer/step'] = function (acc, x) {\n    return this.f(acc, x);\n  };\n\n  return XWrap;\n}();\n\nexport default function _xwrap(fn) {\n  return new XWrap(fn);\n}","import _arity from './internal/_arity.js';\nimport _curry2 from './internal/_curry2.js';\n\n/**\n * Creates a function that is bound to a context.\n * Note: `R.bind` does not provide the additional argument-binding capabilities of\n * [Function.prototype.bind](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n *\n * @func\n * @memberOf R\n * @since v0.6.0\n * @category Function\n * @category Object\n * @sig (* -> *) -> {*} -> (* -> *)\n * @param {Function} fn The function to bind to context\n * @param {Object} thisObj The context to bind `fn` to\n * @return {Function} A function that will execute in the context of `thisObj`.\n * @see R.partial\n * @example\n *\n *      const log = R.bind(console.log, console);\n *      R.pipe(R.assoc('a', 2), R.tap(log), R.assoc('a', 3))({a: 1}); //=> {a: 3}\n *      // logs {a: 2}\n * @symb R.bind(f, o)(a, b) = f.call(o, a, b)\n */\nvar bind = /*#__PURE__*/_curry2(function bind(fn, thisObj) {\n  return _arity(fn.length, function () {\n    return fn.apply(thisObj, arguments);\n  });\n});\nexport default bind;","export default function _arity(n, fn) {\n  /* eslint-disable no-unused-vars */\n  switch (n) {\n    case 0:\n      return function () {\n        return fn.apply(this, arguments);\n      };\n    case 1:\n      return function (a0) {\n        return fn.apply(this, arguments);\n      };\n    case 2:\n      return function (a0, a1) {\n        return fn.apply(this, arguments);\n      };\n    case 3:\n      return function (a0, a1, a2) {\n        return fn.apply(this, arguments);\n      };\n    case 4:\n      return function (a0, a1, a2, a3) {\n        return fn.apply(this, arguments);\n      };\n    case 5:\n      return function (a0, a1, a2, a3, a4) {\n        return fn.apply(this, arguments);\n      };\n    case 6:\n      return function (a0, a1, a2, a3, a4, a5) {\n        return fn.apply(this, arguments);\n      };\n    case 7:\n      return function (a0, a1, a2, a3, a4, a5, a6) {\n        return fn.apply(this, arguments);\n      };\n    case 8:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        return fn.apply(this, arguments);\n      };\n    case 9:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7, a8) {\n        return fn.apply(this, arguments);\n      };\n    case 10:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9) {\n        return fn.apply(this, arguments);\n      };\n    default:\n      throw new Error('First argument to _arity must be a non-negative integer no greater than ten');\n  }\n}","import _isArrayLike from './_isArrayLike.js';\nimport _xwrap from './_xwrap.js';\nimport bind from '../bind.js';\n\nfunction _arrayReduce(xf, acc, list) {\n  var idx = 0;\n  var len = list.length;\n  while (idx < len) {\n    acc = xf['@@transducer/step'](acc, list[idx]);\n    if (acc && acc['@@transducer/reduced']) {\n      acc = acc['@@transducer/value'];\n      break;\n    }\n    idx += 1;\n  }\n  return xf['@@transducer/result'](acc);\n}\n\nfunction _iterableReduce(xf, acc, iter) {\n  var step = iter.next();\n  while (!step.done) {\n    acc = xf['@@transducer/step'](acc, step.value);\n    if (acc && acc['@@transducer/reduced']) {\n      acc = acc['@@transducer/value'];\n      break;\n    }\n    step = iter.next();\n  }\n  return xf['@@transducer/result'](acc);\n}\n\nfunction _methodReduce(xf, acc, obj, methodName) {\n  return xf['@@transducer/result'](obj[methodName](bind(xf['@@transducer/step'], xf), acc));\n}\n\nvar symIterator = typeof Symbol !== 'undefined' ? Symbol.iterator : '@@iterator';\n\nexport default function _reduce(fn, acc, list) {\n  if (typeof fn === 'function') {\n    fn = _xwrap(fn);\n  }\n  if (_isArrayLike(list)) {\n    return _arrayReduce(fn, acc, list);\n  }\n  if (typeof list['fantasy-land/reduce'] === 'function') {\n    return _methodReduce(fn, acc, list, 'fantasy-land/reduce');\n  }\n  if (list[symIterator] != null) {\n    return _iterableReduce(fn, acc, list[symIterator]());\n  }\n  if (typeof list.next === 'function') {\n    return _iterableReduce(fn, acc, list);\n  }\n  if (typeof list.reduce === 'function') {\n    return _methodReduce(fn, acc, list, 'reduce');\n  }\n\n  throw new TypeError('reduce: list must be array or iterable');\n}","import _curry3 from './internal/_curry3.js';\nimport _reduce from './internal/_reduce.js';\n\n/**\n * Returns a single item by iterating through the list, successively calling\n * the iterator function and passing it an accumulator value and the current\n * value from the array, and then passing the result to the next call.\n *\n * The iterator function receives two values: *(acc, value)*. It may use\n * [`R.reduced`](#reduced) to shortcut the iteration.\n *\n * The arguments' order of [`reduceRight`](#reduceRight)'s iterator function\n * is *(value, acc)*.\n *\n * Note: `R.reduce` does not skip deleted or unassigned indices (sparse\n * arrays), unlike the native `Array.prototype.reduce` method. For more details\n * on this behavior, see:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce#Description\n *\n * Dispatches to the `reduce` method of the third argument, if present. When\n * doing so, it is up to the user to handle the [`R.reduced`](#reduced)\n * shortcuting, as this is not implemented by `reduce`.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig ((a, b) -> a) -> a -> [b] -> a\n * @param {Function} fn The iterator function. Receives two values, the accumulator and the\n *        current element from the array.\n * @param {*} acc The accumulator value.\n * @param {Array} list The list to iterate over.\n * @return {*} The final, accumulated value.\n * @see R.reduced, R.addIndex, R.reduceRight\n * @example\n *\n *      R.reduce(R.subtract, 0, [1, 2, 3, 4]) // => ((((0 - 1) - 2) - 3) - 4) = -10\n *      //          -               -10\n *      //         / \\              / \\\n *      //        -   4           -6   4\n *      //       / \\              / \\\n *      //      -   3   ==>     -3   3\n *      //     / \\              / \\\n *      //    -   2           -1   2\n *      //   / \\              / \\\n *      //  0   1            0   1\n *\n * @symb R.reduce(f, a, [b, c, d]) = f(f(f(a, b), c), d)\n */\nvar reduce = /*#__PURE__*/_curry3(_reduce);\nexport default reduce;","import _curry2 from './internal/_curry2.js';\n\n/**\n * Returns the larger of its two arguments.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Relation\n * @sig Ord a => a -> a -> a\n * @param {*} a\n * @param {*} b\n * @return {*}\n * @see R.maxBy, R.min\n * @example\n *\n *      R.max(789, 123); //=> 789\n *      R.max('a', 'b'); //=> 'b'\n */\nvar max = /*#__PURE__*/_curry2(function max(a, b) {\n  return b > a ? b : a;\n});\nexport default max;","export default function _isObject(x) {\n  return Object.prototype.toString.call(x) === '[object Object]';\n}","import _curry3 from './internal/_curry3.js';\nimport _has from './internal/_has.js';\n\n/**\n * Creates a new object with the own properties of the two provided objects. If\n * a key exists in both objects, the provided function is applied to the key\n * and the values associated with the key in each object, with the result being\n * used as the value associated with the key in the returned object.\n *\n * @func\n * @memberOf R\n * @since v0.19.0\n * @category Object\n * @sig ((String, a, a) -> a) -> {a} -> {a} -> {a}\n * @param {Function} fn\n * @param {Object} l\n * @param {Object} r\n * @return {Object}\n * @see R.mergeDeepWithKey, R.merge, R.mergeWith\n * @example\n *\n *      let concatValues = (k, l, r) => k == 'values' ? R.concat(l, r) : r\n *      R.mergeWithKey(concatValues,\n *                     { a: true, thing: 'foo', values: [10, 20] },\n *                     { b: true, thing: 'bar', values: [15, 35] });\n *      //=> { a: true, b: true, thing: 'bar', values: [10, 20, 15, 35] }\n * @symb R.mergeWithKey(f, { x: 1, y: 2 }, { y: 5, z: 3 }) = { x: 1, y: f('y', 2, 5), z: 3 }\n */\nvar mergeWithKey = /*#__PURE__*/_curry3(function mergeWithKey(fn, l, r) {\n  var result = {};\n  var k;\n\n  for (k in l) {\n    if (_has(k, l)) {\n      result[k] = _has(k, r) ? fn(k, l[k], r[k]) : l[k];\n    }\n  }\n\n  for (k in r) {\n    if (_has(k, r) && !_has(k, result)) {\n      result[k] = r[k];\n    }\n  }\n\n  return result;\n});\nexport default mergeWithKey;","import _curry3 from './internal/_curry3.js';\nimport _isObject from './internal/_isObject.js';\nimport mergeWithKey from './mergeWithKey.js';\n\n/**\n * Creates a new object with the own properties of the two provided objects.\n * If a key exists in both objects:\n * - and both associated values are also objects then the values will be\n *   recursively merged.\n * - otherwise the provided function is applied to the key and associated values\n *   using the resulting value as the new value associated with the key.\n * If a key only exists in one object, the value will be associated with the key\n * of the resulting object.\n *\n * @func\n * @memberOf R\n * @since v0.24.0\n * @category Object\n * @sig ((String, a, a) -> a) -> {a} -> {a} -> {a}\n * @param {Function} fn\n * @param {Object} lObj\n * @param {Object} rObj\n * @return {Object}\n * @see R.mergeWithKey, R.mergeDeepWith\n * @example\n *\n *      let concatValues = (k, l, r) => k == 'values' ? R.concat(l, r) : r\n *      R.mergeDeepWithKey(concatValues,\n *                         { a: true, c: { thing: 'foo', values: [10, 20] }},\n *                         { b: true, c: { thing: 'bar', values: [15, 35] }});\n *      //=> { a: true, b: true, c: { thing: 'bar', values: [10, 20, 15, 35] }}\n */\nvar mergeDeepWithKey = /*#__PURE__*/_curry3(function mergeDeepWithKey(fn, lObj, rObj) {\n  return mergeWithKey(function (k, lVal, rVal) {\n    if (_isObject(lVal) && _isObject(rVal)) {\n      return mergeDeepWithKey(fn, lVal, rVal);\n    } else {\n      return fn(k, lVal, rVal);\n    }\n  }, lObj, rObj);\n});\nexport default mergeDeepWithKey;","import _curry2 from './internal/_curry2.js';\nimport mergeDeepWithKey from './mergeDeepWithKey.js';\n\n/**\n * Creates a new object with the own properties of the first object merged with\n * the own properties of the second object. If a key exists in both objects:\n * - and both values are objects, the two values will be recursively merged\n * - otherwise the value from the second object will be used.\n *\n * @func\n * @memberOf R\n * @since v0.24.0\n * @category Object\n * @sig {a} -> {a} -> {a}\n * @param {Object} lObj\n * @param {Object} rObj\n * @return {Object}\n * @see R.merge, R.mergeDeepLeft, R.mergeDeepWith, R.mergeDeepWithKey\n * @example\n *\n *      R.mergeDeepRight({ name: 'fred', age: 10, contact: { email: 'moo@example.com' }},\n *                       { age: 40, contact: { email: 'baa@example.com' }});\n *      //=> { name: 'fred', age: 40, contact: { email: 'baa@example.com' }}\n */\nvar mergeDeepRight = /*#__PURE__*/_curry2(function mergeDeepRight(lObj, rObj) {\n  return mergeDeepWithKey(function (k, lVal, rVal) {\n    return rVal;\n  }, lObj, rObj);\n});\nexport default mergeDeepRight;","import React, {Component} from 'react';\nimport Plot from 'react-plotly.js';\nimport {reduce, max, range, repeat, mergeDeepRight, omit} from 'ramda';\nimport {propTypes, defaultProps} from '../components/NeedlePlot.react';\n\n/**\n * Checks if a variable is representation of a number or not\n * https://stackoverflow.com/questions/9716468/pure-javascript-a-function-like-jquerys-isnumeric\n * @param  {String/FLoat} n  A variable to test.\n * @return {Bool}            True if n is a number, false otherwise.\n */\nfunction isNumeric(n) {\n    return !isNaN(parseFloat(n)) && isFinite(n);\n}\n\n/**\n * Converts an array elements to numbers and ignore the elements which are not\n * a representation of  numbers\n * @param  {Array} test_array An array\n * @return {Array}       An array with only numbers.\n */\nfunction filterNanArray(test_array) {\n    return test_array.filter(el => Number(isNumeric(el)));\n}\n\n/**\n * Search the protein position array for small protein domains (typically 1->5 sites)\n * and bogus entries (i.e. \"?-123\" or \"320-?\"), the protein domains are indicated\n * by the presence of a '-' character in the element of the array.\n * @param  {Array} protein_pos_array        An array containing protein domains\n * @return {Array} positions_array          An array with only single site\n\t\t\t\t\t    protein mutations.\n * @return {Array} domains_array            An array with only small domains\n\t\t\t\t\t    protein mutations.\n * @return {Array} idx_old_positions_array  An array with the indexes of the\n\t\t\t\t\t    single site protein mutations\n\t\t\t\t\t    relative to protein_pos_array\n * @return {Array} idx_bogus_entry          An array with the indexes of the\n\t\t\t\t\t    bogus entries (containing '?')\n\t\t\t\t\t    relative to protein_pos_array\n*/\nfunction extractSmallDomains(protein_pos_array) {\n    const positions_array = [];\n    const domains_array = [];\n    const idx_old_positions_array = [];\n    const idx_bogus_entry = [];\n    protein_pos_array.forEach((dx, i) => {\n        if (dx.indexOf('-') > -1) {\n            const domains_limits = dx.split('-');\n            if (isNumeric(domains_limits[0]) || isNumeric(domains_limits[1])) {\n                idx_bogus_entry.push(i);\n            } else {\n                domains_array.push(dx);\n            }\n        } else {\n            idx_old_positions_array.push(i);\n            positions_array.push(dx);\n        }\n    });\n    return [\n        positions_array,\n        domains_array,\n        idx_old_positions_array,\n        idx_bogus_entry,\n    ];\n}\n\n/**\n * Creates two arrays to plot horizontal lines with many markers\n *\n * @param  {number} xi  start x coordinate of the line\n * @param  {number} xf  stop x coordinate of the line\n * @param  {number} y   y coordinate of the line\n * @param  {int} n      number of markers\n * @return {array} x    x coordinates of the horizontal ine\n * @return {array} y    y coordinates of the horizontal ine\n */\nfunction createHorizontalLine(xi, xf, y, n) {\n    const dx = (xf - xi) / n;\n    const N = Math.max(2, n);\n    const x = range(0, N).map(i => xi + i * dx);\n    return [x, repeat(y, N)];\n}\n\n/**\n * Finds the max of an array while ignoring the NaN values\n *\n * @param  {array} test_array  an array with numbers as entries\n * @return {number}            max value of the array\n */\nfunction nanMax(test_array) {\n    return reduce(max, -Infinity, filterNanArray(test_array));\n}\n\n/**\n * The Needle Plot component is used to visualize large datasets\n * containing categorical or numerical data. The lines and markers in\n * the plot correspond to bars in a histogram.\n **/\nexport default class NeedlePlot extends Component {\n    constructor() {\n        super();\n        this.state = {\n            xStart: null,\n            xEnd: null,\n        };\n        this.handleChange = this.handleChange.bind(this);\n    }\n\n    UNSAFE_componentWillMount() {\n        // For default argument of taken from defaultProps deeply nested\n        this.props = mergeDeepRight(NeedlePlot.defaultProps, this.props);\n    }\n\n    // Handle plot events\n    handleChange(event) {\n        // Zoom\n        if (event['xaxis.range[0]'] || event['xaxis.range']) {\n            this.setState({\n                xStart: event['xaxis.range[0]'] || event['xaxis.range'][0],\n                xEnd: event['xaxis.range[1]'] || event['xaxis.range'][1],\n            });\n        }\n        // Autozoom\n        else if (event['xaxis.autorange'] === true) {\n            this.setState({\n                xStart: null,\n                xEnd: null,\n            });\n        }\n    }\n\n    render() {\n        const {id} = this.props;\n        const {\n            data,\n            globalAnnotation,\n            domainAnnotations,\n        } = this.prepareTraces();\n\n        const layout = this.prepareLayout({\n            data,\n            globalAnnotation,\n            domainAnnotations,\n        });\n\n        return (\n            <div id={id}>\n                <Plot\n                    data={data}\n                    layout={layout}\n                    onRelayout={this.handleChange}\n                    {...omit(['setProps'], this.props)}\n                />\n            </div>\n        );\n    }\n\n    // Fetch data\n    prepareTraces() {\n        const {\n            mutationData: {x, y, mutationGroups, domains},\n            domainStyle: {domainColor, displayMinorDomains},\n            needleStyle: {\n                stemColor,\n                stemThickness,\n                stemConstHeight,\n                headSize,\n                headColor,\n                headSymbol,\n            },\n        } = mergeDeepRight(NeedlePlot.defaultProps, this.props);\n\n        // Apply filtering on protein positions\n        const [\n            x_single_site,\n            small_domains,\n            idx_old_positions_array,\n        ] = extractSmallDomains(x);\n\n        // manage whether headColor is an array or a string\n        const fixed_mutation_colors = Array.isArray(headColor)\n            ? headColor\n            : mutationGroups.map(() => headColor);\n\n        const fixed_mutation_symbols = Array.isArray(headSymbol)\n            ? headSymbol\n            : mutationGroups.map(() => headSymbol);\n\n        const fixed_domain_colors = domainColor;\n\n        const X_DATA_MIN = Math.min.apply(null, x_single_site);\n        const X_DATA_MAX = Math.max.apply(null, x_single_site);\n        const Y_DATA_MAX = stemConstHeight === true ? 1 : nanMax(y);\n        const X_RANGE_MIN = this.state.xStart || X_DATA_MIN;\n        const X_RANGE_MAX = this.state.xEnd || X_DATA_MAX;\n        const XSPAN = X_RANGE_MAX - X_RANGE_MIN;\n        // this is used to trigger a change of display inside annotations\n        const XSPAN_RATIO = 0.2;\n        const Y_BUFFER = stemConstHeight === true ? 0.5 : Y_DATA_MAX / 10;\n        // this is used to scale the position for the annotations\n        const Y_BUFFER_DIVIDER = 2;\n        const Y_TOP = stemConstHeight === true ? 2 : Y_DATA_MAX + Y_BUFFER;\n        const DOMAIN_WIDTH = 33;\n\n        const sequenceDomains = [];\n        const domainAnnotations = [];\n\n        let hoverlabels = [];\n        // contains the height of each stem\n        let stemsY = [];\n        idx_old_positions_array.forEach(idx => {\n            if (stemConstHeight) {\n                stemsY = stemsY.concat([1]);\n            } else {\n                hoverlabels = hoverlabels.concat([\n                    '(' + x[idx] + ',' + y[idx] + ')',\n                ]);\n                stemsY = stemsY.concat([y[idx]]);\n            }\n        });\n\n        const hoverinfo =\n            stemConstHeight === true ? 'x+name+text' : 'name+text';\n\n        // build the different protein large domains\n        domains.forEach((dom, i) => {\n            const domainLimits = dom.coord.split('-');\n            const x0 = Number(domainLimits[0]);\n            const x1 = Number(domainLimits[1]);\n            const domainLength = x1 - x0;\n\n            // Highlight of the protein domain\n            sequenceDomains.push({\n                x: [x1, x0],\n                y: [Y_TOP, Y_TOP],\n                xaxis: 'x1',\n                name: dom.name,\n                fill: 'tozeroy',\n                mode: 'lines',\n                opacity: 0.5,\n                visible: 'legendonly',\n                legendgroup: dom.name,\n                marker: {color: fixed_domain_colors[i]},\n            });\n            const [line_x, line_y] = createHorizontalLine(\n                x0,\n                x1,\n                -Y_BUFFER,\n                x1 - x0\n            );\n\n            sequenceDomains.push({\n                type: 'scatter',\n                mode: 'lines',\n                fill: 'tozeroy',\n                fillcolor: fixed_domain_colors[i],\n                hoveron: 'points+fills',\n                x: line_x,\n                y: line_y,\n                xaxis: 'x2',\n                showlegend: false,\n                hoverinfo: 'name',\n                name: `[${x0}->${x1}] ${dom.name}`,\n                marker: {color: fixed_domain_colors[i]},\n                line: {width: 2},\n            });\n\n            // Name of the protein domain\n            domainAnnotations.push({\n                x: (x0 + x1) / Y_BUFFER_DIVIDER,\n                y: -Y_BUFFER / Y_BUFFER_DIVIDER,\n                showarrow: false,\n                text: dom.name,\n                width: domainLength,\n                align: domainLength < XSPAN_RATIO * XSPAN ? 'right' : 'center',\n            });\n        });\n\n        if (displayMinorDomains === true) {\n            // build the different protein small domains\n            small_domains.forEach(dom => {\n                const x0 = Number(dom.split('-')[0]);\n                const x1 = Number(dom.split('-')[1]);\n                const gname = mutationGroups[x.indexOf(dom)];\n                const [line_x, line_y] = createHorizontalLine(\n                    x0,\n                    x1,\n                    -Y_BUFFER / Y_BUFFER_DIVIDER,\n                    x1 - x0\n                );\n                // Range of the protein domain on the xaxis\n                sequenceDomains.push({\n                    type: 'scatter',\n                    mode: 'lines',\n                    x: line_x,\n                    y: line_y,\n                    fill: 'tozeroy',\n                    fillcolor:\n                        fixed_mutation_colors[\n                            [...new Set(mutationGroups)].indexOf(gname)\n                        ],\n                    hoveron: 'points+fills',\n                    xaxis: 'x2',\n                    hoverinfo: 'name+text',\n                    name: gname,\n                    text: `[${x0}->${x1}] `,\n                    showlegend: false,\n                    marker: {\n                        color:\n                            fixed_mutation_colors[\n                                [...new Set(mutationGroups)].indexOf(gname)\n                            ],\n                    },\n                    line: {width: DOMAIN_WIDTH},\n                });\n            });\n        }\n\n        const globalAnnotation = [\n            {\n                text: `<b>${x_single_site.length +\n                    small_domains.length} Mutations</b>`,\n                x: 0.01,\n                xref: 'paper',\n                y: 1.1,\n                yref: 'paper',\n                showarrow: false,\n                align: 'left',\n            },\n        ];\n\n        const data = [\n            {\n                type: 'scatter',\n                mode: 'markers',\n                x: x_single_site,\n                y: stemsY,\n                xaxis: 'x1',\n                hoverinfo: hoverinfo,\n                text: hoverlabels,\n                error_y: {\n                    type: 'data',\n                    symmetric: false,\n                    array: 0,\n                    arrayminus: stemsY,\n                    thickness: stemThickness,\n                    width: 0,\n                    color: stemColor,\n                },\n                transforms: [\n                    {\n                        type: 'groupby',\n                        groups: mutationGroups,\n                        nameformat: `%{group}`,\n                        styles: [...new Set(mutationGroups)].map(\n                            (target, i) => {\n                                return {\n                                    target: target,\n                                    value: {\n                                        marker: {\n                                            size: headSize,\n                                            symbol: fixed_mutation_symbols[i],\n                                            color: fixed_mutation_colors[i],\n                                        },\n                                    },\n                                };\n                            }\n                        ),\n                    },\n                ],\n            },\n        ].concat(sequenceDomains);\n        return {data, globalAnnotation, domainAnnotations};\n    }\n\n    // Fetch layout\n    prepareLayout(vars) {\n        const {data, globalAnnotation, domainAnnotations} = vars;\n        const {xlabel, ylabel, rangeSlider} = mergeDeepRight(\n            NeedlePlot.defaultProps,\n            this.props\n        );\n        let {xStart, xEnd} = this.state;\n        let first_init = false;\n        // initialize the range based on input data\n        if (Boolean(!xStart) || Boolean(!xEnd)) {\n            first_init = true;\n            data.forEach(trace => {\n                const X_DATA_MIN = Math.min.apply(null, trace.x);\n                const X_DATA_MAX = Math.max.apply(null, trace.x);\n                if (xStart > X_DATA_MIN || Boolean(!xStart)) {\n                    xStart = X_DATA_MIN;\n                }\n                if (xEnd < X_DATA_MAX || Boolean(!xEnd)) {\n                    xEnd = X_DATA_MAX;\n                }\n            });\n        }\n\n        // this is used to zoom in the axis range initially\n        const XSTART_RATIO = 0.98;\n        const XEND_RATIO = 1.02;\n\n        const layout = {\n            legend: {\n                orientation: 'v',\n                x: 1,\n                y: 1.05,\n                bgcolor: 'rgba(255, 255, 255, 0)',\n            },\n            hovermode: 'closest',\n            xaxis: {\n                title: xlabel,\n                showgrid: false,\n                zeroline: false,\n                autorange: Boolean(!xStart),\n                range: [xStart, xEnd],\n                anchor: 'y',\n            },\n            xaxis2: {\n                scaleanchor: 'x',\n                autorange: Boolean(!xStart),\n                range: [xStart, xEnd],\n                anchor: 'y',\n                overlaying: 'x',\n            },\n            yaxis: {\n                title: ylabel,\n                showgrid: false,\n                ticks: 'inside',\n            },\n            margin: {t: 100, l: 40, r: 0, b: 40},\n            annotations: domainAnnotations.concat(globalAnnotation),\n        };\n        if (rangeSlider === true) {\n            layout.xaxis.rangeslider =\n                first_init === true\n                    ? {range: [xStart * XSTART_RATIO, xEnd * XEND_RATIO]}\n                    : {};\n        }\n\n        return layout;\n    }\n}\n\nNeedlePlot.propTypes = propTypes;\nNeedlePlot.defaultProps = defaultProps;\n"],"sourceRoot":""}